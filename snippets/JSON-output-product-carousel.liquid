{ "currencySymbol": "{{ cart.currency.symbol }}",
  "mobileCarousel": "{{ section.settings.mobile_carousel }}",
  "soldOutText": "{{- 'collection.product.sold_out' | t -}}",
  "chooseMoreText": "{{- 'collection.product.choose_options' | t -}}",
  "addToCartText": "{{- 'collection.product.add_to_cart' | t -}}",
 
"blocks":[
{% for block in section.blocks %}
  { "text": "{{ block.settings.collection_text }}", "ruleId": "{{block.settings.rule_id }}" , 
    "collectionData": [
      {% assign limit = 8 %}
      {% assign count = 0 %}
      {% for product in block.settings.collection.products %} 
        {% if count >= limit %} {% break %} {% endif %}
        {% if product.available %} 
          {% unless count == 0 %},{% endunless %}
          {% assign count = count | plus: 1 %}
           {
            "image" : {
              "src": "{{product.featured_image | image_url }}",
              "height": "{{product.featured_image.height | default: 1080 }}",
              "width": "{{product.featured_image.height | default: 1920 }}"
            },
            "variants": [
              {% liquid 
              assign compare_price = product.compare_at_price | default: 0
              assign price = product.price 
              assign discount_percentage = compare_price | minus: price | times: 100.0 |  divided_by: compare_price | round
             %}
              {
                "compare_at_price": "{{ compare_price | money_without_currency | replace: "," , "." }}",
                "price": "{{ price | money_without_currency | replace: "," , "."  }}"
              }
            ],
            "discountPercentage": {{ discount_percentage | default: 0 }},
            "skipFormatMoney": true,
            "vendor" : "{{product.vendor}}",
            "title" : "{{product.title}}",
            "link": "{{product.url}}",
            "tags" : {{product.tags | json }},
            "metafields": [
              {
                "namespace": "okendo",
                "key": "summaryData", 
                "value": {{product.metafields.okendo.summaryData | json }}
              }
            ]
          }
         {% endif %}
       {% endfor%}
    ]
  }
  {%- unless forloop.last %}, {% endunless %}
{% endfor %}
] }
